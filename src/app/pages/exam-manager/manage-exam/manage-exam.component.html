<app-breadcrumbs
  title="MANAGE EXAM"
  [breadcrumbItems]="breadCrumbItems"
></app-breadcrumbs>

<div class="row">
  <div class="col-12">
    <div class="row">
      <div class="col-xxl-6 col-lg-6">
        <div class="card card-body card-hover">
          <div class="d-flex justify-content-between">
            <div class="avatar-sm">
              <div
                class="avatar-title bg-soft-danger text-danger fs-17 rounded"
              >
                OS
              </div>
            </div>
            <div class="text-end">
              <button (click)="openEndOsceConfirmationModal(osceConfirmationModal)" class="btn btn-sm btn-danger">
                End OSCE
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-xxl-6 col-lg-6" >
        <div class="card card-body card-hover">
          <div class="d-flex justify-content-between">
            <div class="avatar-sm">
              <div
                class="avatar-title bg-soft-danger text-danger fs-17 rounded"
              >
                VI
              </div>
            </div>
            <div class="text-end">
              <button class="btn btn-sm btn-danger" (click)="openEndVivaConfirmationModal(vivaConfirmationModal)">
                End VIVA
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-xxl-4 col-lg-4">
        <div class="card card-body card-hover">
          <div class="d-flex justify-content-between">
            <div class="avatar-sm">
              <div
                class="avatar-title bg-soft-primary text-primary fs-17 rounded"
              >
                <i class="ri-repeat-2-line"></i>
              </div>
            </div>
            <div class="text-end">
              <h6>Synchronize Candidates List</h6>
              <button
                class="btn btn-sm btn-success"
                (click)="openSynchronizeCandidateModal(synCandidateModal)"
              >
                Synchronize
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-xxl-4 col-lg-4">
        <div class="card card-body card-hover">
          <div class="d-flex justify-content-between">
            <div class="avatar-sm">
              <div
                class="avatar-title bg-soft-primary text-primary fs-17 rounded"
              >
                <i class="ri-repeat-2-line"></i>
              </div>
            </div>
            <div class="text-end">
              <h6>Synchronize Examiners</h6>
              <button
                class="btn btn-sm btn-success"
                (click)="openSynchronizeExaminerModal(synExaminerModal)"
              >
                Synchronize
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="col-xxl-4 col-lg-4">
        <div class="card card-body card-hover">
          <div class="d-flex justify-content-between">
            <div class="avatar-sm">
              <div
                class="avatar-title bg-soft-primary text-primary fs-17 rounded"
              >
                <i class="ri-repeat-2-line"></i>
              </div>
            </div>
            <div class="text-end">
              <h6>Synchronize Program</h6>
              <button
                class="btn btn-sm btn-success"
                (click)="synchronizePrograms(currentManager.examId)"
              >
                Synchronize
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- end row -->
  </div>
  <!-- end col -->
</div>
<!-- end row -->

<ng-template #synExaminerModal role="document" let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="myModalLabel">Synchronize Examiners</h5>
    <button
      type="button"
      class="btn-close"
      center-bs-dismiss="modal"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-lg-12">
        <div class="mb-3">
          <label for="designation" class="form-label">Select Program</label>
          <select
            class="form-select mb-3"
            aria-label="Default select example"
            #dropBoxRef
            (change)="captureProgramForExaminer(dropBoxRef.value)"
          >
            <option disabled selected>Select Program</option>
            <option
              *ngFor="let program of programList; let i = index"
              value="{{ program.id }}"
            >
              {{ program.name }}
            </option>
          </select>
        </div>
      </div>

      <div class="col-lg-12">
        <div class="hstack gap-2 justify-content-end">
          <button
            type="button"
            class="btn btn-light"
            center-bs-dismiss="modal"
            (click)="modal.dismiss('Cross click')"
          >
            Close
          </button>

          <button class="btn btn-success" (click)="synchronizeExaminers()">
            Synchronize
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #synCandidateModal role="document" let-modal>
  <div class="modal-header">
    <h5 class="modal-title" id="myModalLabel">Synchronize Candidates</h5>
    <button
      type="button"
      class="btn-close"
      center-bs-dismiss="modal"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-lg-12">
        <div class="mb-3">
          <label for="designation" class="form-label">Select Program</label>
          <select
            class="form-select mb-3"
            aria-label="Default select example"
            #dropBoxRef
            (change)="captureProgramForCandidate(dropBoxRef.value)"
          >
            <option disabled selected>Select Program</option>
            <option
              *ngFor="let program of programList; let i = index"
              value="{{ program.id }}"
            >
              {{ program.name }}
            </option>
          </select>
        </div>
      </div>

      <div class="col-lg-12">
        <div class="hstack gap-2 justify-content-end">
          <button
            type="button"
            class="btn btn-light"
            center-bs-dismiss="modal"
            (click)="modal.dismiss('Cross click')"
          >
            Close
          </button>

          <button class="btn btn-success" (click)="synchronizeCandidates()">
            Synchronize
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #osceConfirmationModal let-modal>
  <div class="modal-body p-5">
    <h4 class="mb-4 text-center">Are you sure you want to end OSCE?</h4>
    <div class="row">
      <p class="text-center text-muted">
        You won't be able to revert this!
      </p>
    </div>
    <div class="d-flex justify-content-center gap-2 mt-2">
      <button
        type="button"
        (click)="modal.close('Close click')"
        class="btn btn-primary"
      >
        No, Cancel
      </button>
      <button
        type="button"
        (click)="endOsce();modal.close('Close click') "
        class="btn btn-danger"
      >
        Yes, End Exam
      </button>
    </div>
  </div>
</ng-template>

<ng-template #vivaConfirmationModal let-modal>
  <div class="modal-body p-5">
    <h4 class="mb-4 text-center">Are you sure you want to end VIVA?</h4>
    <div class="row">
      <p class="text-center text-muted">
        You won't be able to revert this!
      </p>
    </div>
    <div class="d-flex justify-content-center gap-2 mt-2">
      <button
        type="button"
        (click)="modal.close('Close click')"
        class="btn btn-primary"
      >
        No, Cancel
      </button>
      <button
        type="button"
        (click)="endViva();modal.close('Close click') "
        class="btn btn-danger"
      >
        Yes, End Exam
      </button>
    </div>
  </div>
</ng-template>